<ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
  xmlns:mhud="clr-namespace:MH.Utils.Dialogs;assembly=MH.Utils"
  xmlns:rd="clr-namespace:MH.UI.WPF.Resources">

  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="../../Brushes.xaml"/>
    <ResourceDictionary Source="../../Effects.xaml"/>
    <ResourceDictionary Source="../Icon.xaml"/>
  </ResourceDictionary.MergedDictionaries>
  
  <DataTemplate DataType="{x:Type mhud:MessageDialog}">
    <DockPanel
      x:Name="PART_Root"
      MinWidth="300"
      Tag="{Binding Result, Mode=TwoWay}">
      
      <!-- Buttons -->
      <ItemsControl
        DockPanel.Dock="Bottom"
        ItemsSource="{Binding Buttons}">
                    
        <ItemsControl.ItemsPanel>
          <ItemsPanelTemplate>
            <StackPanel
              Orientation="Horizontal"
              HorizontalAlignment="Right"
              Margin="5"/>
          </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>

        <ItemsControl.ItemTemplate>
          <DataTemplate>
            <Button
              IsDefault="{Binding IsDefault}"
              IsCancel="{Binding IsCancel}">
              
              <b:Interaction.Triggers>
                <b:EventTrigger EventName="Click">
                  <b:ChangePropertyAction
                    PropertyName="Tag"
                    TargetObject="{Binding ElementName=PART_Root}"
                    Value="{Binding Result}"/>
                </b:EventTrigger>
              </b:Interaction.Triggers>

              <Button.Content>
                <DockPanel>
                  <Path
                    DockPanel.Dock="Left"
                    Style="{StaticResource MH.Styles.Icon}"
                    Effect="{StaticResource MH.Effects.DropShadow}"
                    Margin="5,5,0,5"
                    Width="12"
                    Height="12"
                    Data="{Binding Icon,
                           Converter={StaticResource ResourceConverter}}"
                    Fill="{Binding Icon,
                           Converter={StaticResource ResourceConverter},
                           ConverterParameter={x:Static rd:Dictionaries.IconNameToBrush}}"
                    Visibility="{Binding Icon,
                                 Converter={StaticResource AllToVisibilityConverter}}"/>

                  <TextBlock
                    Text="{Binding Text}"
                    VerticalAlignment="Center"
                    Margin="10,0,10,0"
                    FontSize="13"/>
                </DockPanel>
              </Button.Content>
            </Button>
          </DataTemplate>
        </ItemsControl.ItemTemplate>

        <ItemsControl.ItemContainerStyle>
          <Style>
            <Setter Property="Control.MinWidth" Value="60"/>
            <Setter Property="Control.MinHeight" Value="30"/>
            <Setter Property="Control.Margin" Value="5"/>
          </Style>
        </ItemsControl.ItemContainerStyle>
      </ItemsControl>
      
      <!-- Icon and Message -->
      <DockPanel>
        <Path
          DockPanel.Dock="Left"
          Style="{StaticResource MH.Styles.Icon}"
          Effect="{StaticResource MH.Effects.DropShadow}"
          Width="32"
          Height="32"
          Margin="10"
          Data="{Binding Icon,
                 Converter={StaticResource ResourceConverter}}"/>

         <TextBlock
           Text="{Binding Message}"
           VerticalAlignment="Center"
           FontSize="14"
           Margin="0,0,10,0"/>
      </DockPanel>
    </DockPanel>
  </DataTemplate>
    
</ResourceDictionary>