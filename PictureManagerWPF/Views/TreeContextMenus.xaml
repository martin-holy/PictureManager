<ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:sys="clr-namespace:System;assembly=System.Runtime"
  xmlns:mhuibc="clr-namespace:MH.UI.BaseClasses;assembly=MH.UI"
  xmlns:pm="clr-namespace:PictureManager"
  xmlns:md="clr-namespace:PictureManager.Domain.Dialogs;assembly=PictureManager.Domain"
  xmlns:tc="clr-namespace:PictureManager.Domain.TreeCategories;assembly=PictureManager.Domain"
  xmlns:mhConv="clr-namespace:MH.UI.WPF.Converters;assembly=MH.UI.WPF"
  xmlns:vm="clr-namespace:PictureManager.Domain.ViewModels;assembly=PictureManager.Domain">

  <Style x:Key="PM.MiFilter" TargetType="MenuItem" BasedOn="{StaticResource MH.Styles.BaseControls.MenuItem}">
    <Setter Property="Visibility" Value="{Binding MediaItemsViews.Current, Source={x:Static pm:App.Core}, Converter={x:Static mhConv:VisibilityConverter.AllToVisible}}"/>
  </Style>

  <!-- Tag Items Load and Filters -->
  <x:Array Type="{x:Type sys:Object}" x:Key="TagItemTreeContextMenu" x:Shared="False">
    <MenuItem Command="{Binding MediaItemsViews.LoadByTagCommand, Source={x:Static pm:App.Core}}" CommandParameter="{Binding}"/>
    <MenuItem Command="{Binding MediaItemsViews.Current.Filter.SetAndCommand, Source={x:Static pm:App.Core}}" CommandParameter="{Binding}" Style="{StaticResource PM.MiFilter}"/>
    <MenuItem Command="{Binding MediaItemsViews.Current.Filter.SetOrCommand, Source={x:Static pm:App.Core}}" CommandParameter="{Binding}" Style="{StaticResource PM.MiFilter}"/>
    <MenuItem Command="{Binding MediaItemsViews.Current.Filter.SetNotCommand, Source={x:Static pm:App.Core}}" CommandParameter="{Binding}" Style="{StaticResource PM.MiFilter}"/>
  </x:Array>

  <!-- People -->
  <ContextMenu x:Key="TreeContextMenuPeople" DataContext="{Binding PlacementTarget.(FrameworkElement.DataContext), RelativeSource={RelativeSource Self}}">
    <MenuItem Command="mhuibc:TreeCategory.ItemCreateCommand" CommandParameter="{Binding}"/>
    <MenuItem Command="mhuibc:TreeCategory.GroupCreateCommand" CommandParameter="{Binding}"/>
  </ContextMenu>
  
  <!-- Person -->
  <ContextMenu x:Key="TreeContextMenuPerson" DataContext="{Binding PlacementTarget.(FrameworkElement.DataContext), RelativeSource={RelativeSource Self}}">
    <ContextMenu.ItemsSource>
      <CompositeCollection>
        <MenuItem Command="vm:ToolsTabsVM.OpenPersonDetailTabCommand" CommandParameter="{Binding}"/>
        <MenuItem Command="mhuibc:TreeCategory.ItemRenameCommand" CommandParameter="{Binding}"/>
        <MenuItem Command="mhuibc:TreeCategory.ItemDeleteCommand" CommandParameter="{Binding}"/>
        <Separator/>
        <CollectionContainer Collection="{StaticResource TagItemTreeContextMenu}"/>
      </CompositeCollection>
    </ContextMenu.ItemsSource>
  </ContextMenu>

  <!-- Folder Keywords -->
  <ContextMenu x:Key="TreeContextMenuFolderKeywords">
    <MenuItem Command="md:FolderKeywordsDialogM.OpenCommand"/>
  </ContextMenu>

  <!-- Keywords -->
  <ContextMenu x:Key="TreeContextMenuKeywords" DataContext="{Binding PlacementTarget.(FrameworkElement.DataContext), RelativeSource={RelativeSource Self}}">
    <MenuItem Command="mhuibc:TreeCategory.ItemCreateCommand" CommandParameter="{Binding}"/>
    <MenuItem Command="mhuibc:TreeCategory.GroupCreateCommand" CommandParameter="{Binding}"/>
  </ContextMenu>

  <!-- GeoNames -->
  <ContextMenu x:Key="TreeContextMenuGeoNames" DataContext="{Binding Source={x:Static pm:App.Core}}">
    <MenuItem Command="{Binding VM.GetGeoNamesFromWebCommand}"/>
    <MenuItem Command="{Binding GeoNamesM.NewGeoNameFromGpsCommand}"/>
    <MenuItem Command="{Binding VM.ReadGeoLocationFromFilesCommand}"/>
  </ContextMenu>

  <!-- Viewers -->
  <ContextMenu x:Key="TreeContextMenuViewers" DataContext="{Binding PlacementTarget.(FrameworkElement.DataContext), RelativeSource={RelativeSource Self}}">
    <MenuItem Command="mhuibc:TreeCategory.ItemCreateCommand" CommandParameter="{Binding}"/>
  </ContextMenu>
  
   <!-- Tree Category Group -->
  <ContextMenu x:Key="TreeContextMenuGroup" DataContext="{Binding PlacementTarget.(FrameworkElement.DataContext), RelativeSource={RelativeSource Self}}">
    <MenuItem Command="mhuibc:TreeCategory.ItemCreateCommand" CommandParameter="{Binding}"/>
    <MenuItem Command="mhuibc:TreeCategory.GroupRenameCommand" CommandParameter="{Binding}"/>
    <MenuItem Command="mhuibc:TreeCategory.GroupDeleteCommand" CommandParameter="{Binding}"/>
  </ContextMenu>
  
  <!-- Drive -->
  <ContextMenu x:Key="TreeContextMenuDrive" DataContext="{Binding PlacementTarget.(FrameworkElement.DataContext), RelativeSource={RelativeSource Self}}">
    <MenuItem Command="mhuibc:TreeCategory.ItemCreateCommand" CommandParameter="{Binding}"/>
  </ContextMenu>
  
  <!-- Folder -->
  <ContextMenu x:Key="TreeContextMenuFolder" DataContext="{Binding PlacementTarget.(FrameworkElement.DataContext), RelativeSource={RelativeSource Self}}">
    <MenuItem Command="mhuibc:TreeCategory.ItemCreateCommand" CommandParameter="{Binding}"/>
    <MenuItem Command="mhuibc:TreeCategory.ItemRenameCommand" CommandParameter="{Binding}"/>
    <MenuItem Command="mhuibc:TreeCategory.ItemDeleteCommand" CommandParameter="{Binding}"/>
    <Separator/>
    <MenuItem Command="tc:FavoriteFoldersTreeCategory.AddToFavoritesCommand" CommandParameter="{Binding}"/>
    <MenuItem Command="tc:FolderKeywordsTreeCategory.SetAsFolderKeywordCommand" CommandParameter="{Binding}"/>

    <MenuItem Header="GeoLocation">
      <MenuItem.Icon>
        <Path Data="{StaticResource IconLocationCheckin}" Style="{StaticResource MH.Styles.IconWithShadow}"/>
      </MenuItem.Icon>
      <MenuItem Command="{Binding VM.GetGeoNamesFromWebCommand, Source={x:Static pm:App.Core}}" CommandParameter="{Binding}"/>
      <MenuItem Command="{Binding VM.ReadGeoLocationFromFilesCommand, Source={x:Static pm:App.Core}}" CommandParameter="{Binding}"/>
    </MenuItem>

    <MenuItem Header="Media Items">
      <MenuItem.Icon>
        <Path Data="{StaticResource IconImageMultiple}" Style="{StaticResource MH.Styles.IconWithShadow}"/>
      </MenuItem.Icon>
      <MenuItem Command="{Binding VM.CompressImagesCommand, Source={x:Static pm:App.Core}}" CommandParameter="{Binding}"/>
      <MenuItem Command="{Binding MediaItemsViews.RebuildThumbnailsCommand, Source={x:Static pm:App.Core}}" CommandParameter="{Binding}"/>
      <MenuItem Command="{Binding VM.ReloadMetadataCommand, Source={x:Static pm:App.Core}}" CommandParameter="{Binding}"/>
      <MenuItem Command="{Binding VM.ResizeImagesCommand, Source={x:Static pm:App.Core}}" CommandParameter="{Binding}"/>
      <MenuItem Command="{Binding VM.SaveImageMetadataToFilesCommand, Source={x:Static pm:App.Core}}" CommandParameter="{Binding}"/>
    </MenuItem>
  </ContextMenu>
  
  <!-- Favorite Folder -->
  <ContextMenu x:Key="TreeContextMenuFavoriteFolder" DataContext="{Binding PlacementTarget.(FrameworkElement.DataContext), RelativeSource={RelativeSource Self}}">
    <MenuItem Command="mhuibc:TreeCategory.ItemRenameCommand" CommandParameter="{Binding}"/>
    <MenuItem Command="mhuibc:TreeCategory.ItemDeleteCommand" CommandParameter="{Binding}"/>
  </ContextMenu>
  
  <!-- GeoName -->
  <ContextMenu
    x:Key="TreeContextMenuGeoName"
    DataContext="{Binding PlacementTarget.(FrameworkElement.DataContext), RelativeSource={RelativeSource Self}}"
    ItemsSource="{StaticResource TagItemTreeContextMenu}"/>
  
  <!-- Keyword -->
  <ContextMenu x:Key="TreeContextMenuKeyword" DataContext="{Binding PlacementTarget.(FrameworkElement.DataContext), RelativeSource={RelativeSource Self}}">
    <ContextMenu.ItemsSource>
      <CompositeCollection>
        <MenuItem Command="mhuibc:TreeCategory.ItemCreateCommand" CommandParameter="{Binding}"/>
        <MenuItem Command="mhuibc:TreeCategory.ItemRenameCommand" CommandParameter="{Binding}"/>
        <MenuItem Command="mhuibc:TreeCategory.ItemDeleteCommand" CommandParameter="{Binding}"/>
        <Separator/>
        <CollectionContainer Collection="{StaticResource TagItemTreeContextMenu}"/>
      </CompositeCollection>
    </ContextMenu.ItemsSource>
  </ContextMenu>
  
  <!-- Viewer -->
  <ContextMenu x:Key="TreeContextMenuViewer" DataContext="{Binding PlacementTarget.(FrameworkElement.DataContext), RelativeSource={RelativeSource Self}}">
    <MenuItem Command="mhuibc:TreeCategory.ItemRenameCommand" CommandParameter="{Binding}"/>
    <MenuItem Command="mhuibc:TreeCategory.ItemDeleteCommand" CommandParameter="{Binding}"/>
  </ContextMenu>
    
</ResourceDictionary>