<Window
  x:Class="PictureManager.Views.MainWindowV"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
  xmlns:mhc="clr-namespace:MH.UI.WPF.Controls;assembly=MH.UI.WPF"
  xmlns:pm="clr-namespace:PictureManager"
  xmlns:sys="clr-namespace:System;assembly=System.Runtime"
  DataContext="{Binding MainWindowVM, Source={x:Static pm:App.Ui}}"
  Title="Picture Manager"
  WindowState="Maximized"
  WindowStyle="SingleBorderWindow"
  UseLayoutRounding="True"
  SnapsToDevicePixels="True"
  Background="{StaticResource ColorBrushBackground}"
  FontSize="14"
  Foreground="{StaticResource WhiteBrush}">

  <Window.InputBindings>
    <KeyBinding Modifiers="Control" Key="E" Command="{Binding CoreM.MediaItemsM.EditCommand}"/>
    <KeyBinding Modifiers="Control" Key="S" Command="{Binding CoreM.MediaItemsM.SaveEditCommand}"/>
    <KeyBinding Modifiers="Control" Key="Q" Command="{Binding CoreM.MediaItemsM.CancelEditCommand}"/>
    <KeyBinding Key="F2" Command="{Binding CoreM.MediaItemsM.RenameCommand}"/>
    <KeyBinding Key="Delete" Command="{Binding CoreVM.MediaItemsVM.DeleteCommand}"/>
    <KeyBinding Modifiers="Control" Key="K" Command="{Binding CoreM.MediaItemsM.CommentCommand}"/>
  </Window.InputBindings>

  <b:Interaction.Triggers>
    <b:EventTrigger EventName="Closing">
      <b:InvokeCommandAction Command="{Binding ClosingCommand}"/>
    </b:EventTrigger>
    <b:EventTrigger EventName="Loaded">
      <b:InvokeCommandAction Command="{Binding LoadedCommand}"/>
    </b:EventTrigger>
    <b:EventTrigger EventName="StateChanged">
      <b:InvokeCommandAction
        Command="{Binding WindowStateChangedCommand}"
        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"/>
    </b:EventTrigger>
  </b:Interaction.Triggers>

  <!-- WindowChrome blocks controls like buttons on SlidePanel.
   I need to find the way how to set CaptionHeight to 0 or 30.
   It is ok when the WindowStyle is none. like in full screen mode.
   But WindowStyle none hides TaskBar
   try something with z-index
   TODO delete WindowChrome and create custom window control with WindowStyle is none -->
  <WindowChrome.WindowChrome>
    <WindowChrome CaptionHeight="10" />
  </WindowChrome.WindowChrome>

  <Border BorderBrush="Black">
    <Border.Style>
      <Style TargetType="{x:Type Border}">
        <Setter Property="BorderThickness" Value="7"/>
        <Style.Triggers>
          <DataTrigger Binding="{Binding FixWindowSize}" Value="False">
            <Setter Property="BorderThickness" Value="0"/>
          </DataTrigger>
        </Style.Triggers>
      </Style>
    </Border.Style>

    <mhc:SlidePanelsGrid ActiveLayout="{Binding Model.ActiveLayout}">
      <mhc:SlidePanelsGrid.PinLayouts>
        <!-- Left, Top, Right, Bottom -->
        <x:Array Type="{x:Type sys:Array}">
          <!-- Browser -->
          <x:Array Type="{x:Type sys:Boolean}">
            <sys:Boolean>True</sys:Boolean>
            <sys:Boolean>True</sys:Boolean>
            <sys:Boolean>False</sys:Boolean>
            <sys:Boolean>True</sys:Boolean>
          </x:Array>
          <!-- Viewer -->
          <x:Array Type="{x:Type sys:Boolean}">
            <sys:Boolean>False</sys:Boolean>
            <sys:Boolean>False</sys:Boolean>
            <sys:Boolean>False</sys:Boolean>
            <sys:Boolean>True</sys:Boolean>
          </x:Array>
        </x:Array>
      </mhc:SlidePanelsGrid.PinLayouts>

      <!-- Main Window Tool Bar -->
      <mhc:SlidePanelsGrid.PanelTop>
        <mhc:SlidePanel
          Content="{Binding CoreVM.MainWindowToolBarVM}"
          Height="30"/>
      </mhc:SlidePanelsGrid.PanelTop>

      <!-- Tree View Categories -->
      <mhc:SlidePanelsGrid.PanelLeft>
        <mhc:SlidePanel
          Content="{Binding CoreVM.TreeViewCategoriesVM}"
          Width="380"/>
      </mhc:SlidePanelsGrid.PanelLeft>

      <mhc:SlidePanelsGrid.PanelMiddle>
        <Grid>
          <!-- Main Tabs -->
          <ContentPresenter
            Content="{Binding CoreVM.MainTabsVM}"
            Visibility="{Binding MediaViewerVM.IsVisible,
                         Source={x:Static pm:App.Ui},
                         Converter={StaticResource AllToVisibilityConverter}, 
                         ConverterParameter={StaticResource False}}"/>

          <!-- Media Viewer -->
          <ContentPresenter Content="{Binding CoreVM.MediaViewerVM}"/>
        </Grid>
      </mhc:SlidePanelsGrid.PanelMiddle>

      <!-- Tools Tabs -->
      <mhc:SlidePanelsGrid.PanelRight>
        <mhc:SlidePanel
          IsOpen="{Binding CoreVM.ToolsTabsVM.IsOpen, Mode=TwoWay}"
          CanOpen="{Binding CoreVM.ToolsTabsVM.Items.Count, Converter={StaticResource AllToBoolConverter}}"
          Content="{Binding CoreVM.ToolsTabsVM}"
          Width="360"/>
      </mhc:SlidePanelsGrid.PanelRight>

      <!-- Status Panel -->
      <mhc:SlidePanelsGrid.PanelBottom>
        <mhc:SlidePanel
          Content="{Binding CoreM.StatusPanelM}"
          CanOpen="{Binding CanOpenStatusPanel}"
          MinHeight="30"/>
      </mhc:SlidePanelsGrid.PanelBottom>
    </mhc:SlidePanelsGrid>
  </Border>
</Window>