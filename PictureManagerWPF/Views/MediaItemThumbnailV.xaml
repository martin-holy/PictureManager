<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:vm="clr-namespace:PictureManager.ViewModels"
                    xmlns:pmd="clr-namespace:PictureManager.Domain;assembly=PictureManager.Domain"
                    xmlns:mhc="clr-namespace:MH.UI.WPF.Controls;assembly=MH.UI.WPF"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib">

  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="../ResourceDictionaries/Converters.xaml" />
    <ResourceDictionary Source="../ResourceDictionaries/NamedStyles/BorderStyles.xaml" />
    <ResourceDictionary Source="../ResourceDictionaries/NamedStyles/TextBlockStyles.xaml" />
    <ResourceDictionary Source="../ResourceDictionaries/Icons.xaml" />
    <ResourceDictionary Source="/MH.UI.WPF;component/Resources/EqualityConverterSigns.xaml" />
  </ResourceDictionary.MergedDictionaries>

  <sys:Int32 x:Key="ThumbnailInfoMinSize">170</sys:Int32>

  <DataTemplate x:Key="MediaItemThumbnailV" DataType="{x:Type vm:MediaItemBaseVM}">
    <Border x:Name="PART_Border"
            Width="{Binding Model.ThumbWidth}"
            Height="{Binding Model.ThumbHeight}"
            BorderThickness="2"
            Margin="1"
            ClipToBounds="True">

      <Border.Style>
        <Style TargetType="{x:Type Border}">
          <Setter Property="BorderBrush" Value="Black" />

          <Style.Triggers>
            <DataTrigger Binding="{Binding Model.IsSelected}" Value="True">
              <Setter Property="BorderBrush" Value="{DynamicResource AccentColorBrush}" />
            </DataTrigger>
          </Style.Triggers>
        </Style>
      </Border.Style>

      <Grid x:Name="PART_Grid">
        <!-- Thumbnail Image -->
        <Image Source="{Binding Model.FilePathCache,
                        Converter={StaticResource ImageSourceConverter}}"
               Stretch="Fill" />

        <!-- Video over layer -->
        <ContentControl Content="&#xE29E;"
                        FontFamily="Segoe UI Symbol"
                        FontSize="20" 
                        VerticalAlignment="Center"
                        HorizontalAlignment="Center"
                        Opacity="0.77"
                        Visibility="{Binding Model.MediaType, 
                                     Converter={StaticResource AllToVisibilityConverter},
                                     ConverterParameter={x:Static pmd:MediaType.Video}}">
        </ContentControl>

        <!-- Video Clips over layer -->
        <mhc:Icon Source="{StaticResource IconImageMultiple}"
                  Size="20"
                  HorizontalAlignment="Right"
                  VerticalAlignment="Bottom"
                  Margin="5"
                  Visibility="{Binding Model.HasVideoClips,
                               Converter={StaticResource AllToVisibilityConverter}}" />

        <!-- Thumbnail Info Box -->
        <ItemsControl ItemsSource="{Binding InfoBoxThumb}">
          <ItemsControl.Style>
            <Style TargetType="{x:Type ItemsControl}">
              <Style.Triggers>
                <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=Border}}" Value="True">
                  <Setter Property="Visibility" Value="Hidden"/>
                </DataTrigger>

                <DataTrigger Value="True">
                  <DataTrigger.Binding>
                    <MultiBinding Converter="{StaticResource EqualityConverter}">
                      <Binding Path="Model.ThumbWidth" />
                      <Binding Source="{StaticResource SignLessThan}" />
                      <Binding Source="{StaticResource ThumbnailInfoMinSize}" />
                    </MultiBinding>
                  </DataTrigger.Binding>

                  <Setter Property="Visibility" Value="Hidden"/>
                </DataTrigger>

              </Style.Triggers>
            </Style>
          </ItemsControl.Style>

          <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
              <WrapPanel Orientation="Horizontal" />
            </ItemsPanelTemplate>
          </ItemsControl.ItemsPanel>

          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <Border Style="{StaticResource SBorderTextThumb}">
                <TextBlock Style="{StaticResource STextBlock}"
                           TextWrapping="Wrap"
                           Text="{Binding}" />
              </Border>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>

        <!-- Selected over layer -->
        <Grid Visibility="{Binding Model.IsSelected, Converter={StaticResource AllToVisibilityConverter}}">
          <Polygon Width="40"
                   Height="40"
                   Points="0,0 40,0 40,40"
                   Stroke="Black"
                   StrokeThickness="2"
                   HorizontalAlignment="Right"
                   VerticalAlignment="Top"
                   Fill="{DynamicResource AccentColorBrush}" />

          <Border HorizontalAlignment="Stretch"
                  VerticalAlignment="Stretch"
                  BorderThickness="2"
                  BorderBrush="Black" />
        </Grid>

      </Grid>
    </Border>
  </DataTemplate>
</ResourceDictionary>