<!-- saved from url=(0026)http://msdn.microsoft.com/ -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Picture Manager - Full Picture Size</title>

    <script>
      var picBiggerThanScreen;
      var clientMouseDownX;
      var clientMouseDownY;
      var picMarginTop;
      var picMarginLeft;
      var picMouseIsDown;
      var picIsRotated;

      //to enable ScriptErrorsSuppressed = true
      function noError() { return true; }
      window.onerror = noError;

      function Body_OnMouseWheel(event) {
        window.external.FullPicMouseWheel(event.wheelDelta);
      }

      function FullPic_OnMouseDown(event) {
        picMouseIsDown = true;
        if (picBiggerThanScreen) {
          var pic = event.currentTarget;
          var picMouseDownX = event.x;
          var picMouseDownY = event.y;

          clientMouseDownX = event.clientX;
          clientMouseDownY = event.clientY;

          if (picIsRotated) {
            var offset = ((pic.naturalWidth - pic.naturalHeight) / 2);
            picMarginTop = Math.round(offset + event.clientY - ((pic.naturalWidth / pic.width) * picMouseDownY));
            picMarginLeft = Math.round((offset * -1) + event.clientX - ((pic.naturalHeight / pic.height) * picMouseDownX));
          } else {
            picMarginTop = Math.round(event.clientY - ((pic.naturalHeight / pic.height) * picMouseDownY));
            picMarginLeft = Math.round(event.clientX - ((pic.naturalWidth / pic.width) * picMouseDownX));
          }

          pic.style.marginTop = picMarginTop + "px";
          pic.style.marginLeft = picMarginLeft + "px";

          pic.width = pic.naturalWidth;
          pic.height = pic.naturalHeight;
        }
      }

      function FullPic_OnMouseUp() {
        picMouseIsDown = false;
        if (picBiggerThanScreen) {
          var pic = document.getElementById("fullPic");
          if (pic !== undefined && pic !== null) {
            pic.style.marginTop = "";
            pic.style.marginLeft = "";
          }
          FitPicture();
        }
      }

      function FullPic_OnMouseMove(event) {
        if (picMouseIsDown && picBiggerThanScreen) {
          var pic = document.getElementById("fullPic");
          if (pic !== undefined && pic !== null) {
            var yDiff = clientMouseDownY - event.clientY;
            var xDiff = clientMouseDownX - event.clientX;

            pic.style.marginTop = (picMarginTop - yDiff) + "px";
            pic.style.marginLeft = (picMarginLeft - xDiff) + "px";
          }
        }
      }

      function FitPicture() {
        var pic = document.getElementById("fullPic");
        if (pic === undefined || pic === null) return;
        pic.removeAttribute("height");
        pic.removeAttribute("width");

        //if the picture is rotated, switch width and height
        picIsRotated = (pic.style.transform.indexOf("270deg") > 0 || pic.style.transform.indexOf("90deg") > 0);

        var bh = window.document.body.clientHeight;
        var bw = window.document.body.clientWidth;
        var pnh;
        var pnw;

        if (picIsRotated) {
          pnw = pic.naturalHeight;
          pnh = pic.naturalWidth;
        } else {
          pnh = pic.naturalHeight;
          pnw = pic.naturalWidth;
        }

        if ((pnh > bh) || (pnw > bw)) { //picture is bigger than window  
          picBiggerThanScreen = true;
          pic.className = "";

          var ph;
          var pw;
          if (bh / pnh > bw / pnw) { //landscape
            pw = bw;
            ph = pnh * (bw / pnw);
          } else {
            pw = pnw * (bh / pnh);
            ph = bh;
          }

          if (picIsRotated) {
            var tmp = pw;
            pw = ph;
            ph = tmp;
          }

          pic.height = ph;
          pic.width = pw;
          pic.style.marginTop = ((bh - ph) / 2) + "px";
          pic.style.marginLeft = ((bw - pw) / 2) + "px";

        } else {
          picBiggerThanScreen = false;
          pic.className = "centerFullPic";
          pic.height = pnh;
          pic.width = pnw;
        }

        pic.style.display = "block";
      }

      function SetPicture(src, orientation) {
        var pic = document.getElementById("fullPic");
        if (pic === undefined || pic === null) return;
        pic.style.marginTop = null;
        pic.style.marginLeft = null;
        pic.style.display = "none";
        pic.style.transform = "rotate(" + orientation + "deg)";
        pic.src = src;
      }

      function SetInfo(infoText) {
        var info = document.getElementById("info");
        if (info === undefined || info === null) return;
        info.innerHTML = infoText;
      }
    </script>

    <style>
      body, html {
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        background-color: #252525;
        overflow: hidden;
      }

      .centerFullPic {
        position: absolute;
        margin: auto;
        bottom: 0;
        left: 0;
        right: 0;
      }

      #fullPicBox {
        height: 100%;
        background-position-x: center;
        background-position-y: center;
        background-size: contain;
        background-repeat: no-repeat;
      }

      #info {
        position: absolute;
        color: white;
        font-size: 18px;
        z-index: 1;
      }

      #info div {
        margin: 2px;
        padding: 2px;
        background-color: rgba(0, 0, 0, 0.4);
        display: inline-block;
        border: 1px solid black;
      }
    </style>
  </head>
  <body OnMouseWheel="Body_OnMouseWheel(event);" OnResize="FitPicture();">
    <div id="info"></div>
    <div id="content">
      <div id="fullPicBox">
        <img id="fullPic" draggable="false"
          OnMouseDown="FullPic_OnMouseDown(event);"
          OnMouseUp="FullPic_OnMouseUp();"
          OnMouseMove="FullPic_OnMouseMove(event);"
          OnLoad="FitPicture();"
          src="">
      </div>
    </div>
  </body>
</html>