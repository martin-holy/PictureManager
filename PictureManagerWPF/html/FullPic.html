<!-- saved from url=(0026)http://msdn.microsoft.com/ -->
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" http-equiv="X-UA-Compatible" content="IE=10" />
<title>Picture Manager - Full Picture Size</title>

<script>
  var picIsBiggerThanScreen;
  var clientMouseDownX;
  var clientMouseDownY;
  var picMouseIsDown;
  var picIsRotated;
  var picIsZoomed;
  var picZoomLevel;
  var currentFullPicId = "fullPicA";

  //to enable ScriptErrorsSuppressed = true
  function noError() { return true; }
  window.onerror = noError;

  function Body_OnMouseWheel(event) {
    window.external.FullPicMouseWheel(event.wheelDelta);
  }

  function Zoom(zoomIn) {
    if (!zoomIn && picZoomLevel <= 10) return;
    var pic = document.getElementById(currentFullPicId);
    var halfBh = Math.round(window.document.body.clientHeight / 2);
    var halfBw = Math.round(window.document.body.clientWidth / 2);
    picIsZoomed = true;
    var picT = halfBh - pic.style.top.replace("px", "");
    var picL = halfBw - pic.style.left.replace("px", "");
    //SetPic(pic, zoomIn ? picZoomLevel + 10 : picZoomLevel - 10, picT, picL, halfBh, halfBw, false);
    SetPic(pic, zoomIn ? picZoomLevel * 1.5 : picZoomLevel / 1.5, picT, picL, halfBh, halfBw, false);
        
    SetZoomInfo();
  }

  function SetPic(pic, zoom, picT, picL, scrT, scrL, fromClick) {
    picZoomLevel = zoom;
    var ratio = (pic.naturalHeight * (zoom / 100)) / pic.height;

    pic.height = pic.naturalHeight * (zoom / 100);
    pic.width = pic.naturalWidth * (zoom / 100);

    var offset = (picIsRotated && fromClick) ? ((pic.height - pic.width) / 2) : 0;
    var picTop = Math.round((offset * -1) + scrT - (ratio * picT));
    var picLeft = Math.round(offset + scrL - (ratio * picL));

    pic.style.top = picTop + "px";
    pic.style.left = picLeft + "px";
  }

  function FullPic_OnMouseDown(event) {
    picMouseIsDown = true;
    clientMouseDownX = event.clientX;
    clientMouseDownY = event.clientY;

    if (picIsBiggerThanScreen && !picIsZoomed) {
      SetPic(event.currentTarget, 100, event.y, event.x, event.clientY, event.clientX, true);
    }
  }

  function FullPic_OnMouseUp(event) {
    picMouseIsDown = false;
    if (!picIsZoomed) {
      FitPicture(event);
    }
  }

  function FullPic_OnMouseMove(event) {
    if (picMouseIsDown && (picIsBiggerThanScreen || picIsZoomed)) {
      var yDiff = clientMouseDownY - event.clientY;
      var xDiff = clientMouseDownX - event.clientX;

      clientMouseDownX = event.clientX;
      clientMouseDownY = event.clientY;

      event.currentTarget.style.top = (event.currentTarget.style.top.replace("px", "") - yDiff) + "px";
      event.currentTarget.style.left = (event.currentTarget.style.left.replace("px", "") - xDiff) + "px";
    }
  }

  function FullPic_OnLoad(pic) {
    FitPicture(pic);
    SwitchToCurrentMediaItem("image");
  }

  function FitPicture(pic) {
    if (pic === undefined || pic === null) return;
    picIsZoomed = false;
    pic.removeAttribute("height");
    pic.removeAttribute("width");

    var pnh;
    var pnw;
    //if the picture is rotated, switch width and height
    picIsRotated = (pic.style.transform.indexOf("270deg") > 0 || pic.style.transform.indexOf("90deg") > 0);
    if (picIsRotated) {
      pnw = pic.naturalHeight;
      pnh = pic.naturalWidth;
    } else {
      pnh = pic.naturalHeight;
      pnw = pic.naturalWidth;
    }

    var bh = window.document.body.clientHeight;
    var bw = window.document.body.clientWidth;
    picIsBiggerThanScreen = (pnh > bh) || (pnw > bw);

    var ph;
    var pw;

    if (picIsBiggerThanScreen) { //picture is bigger than window  
      if (bh / pnh > bw / pnw) { //landscape
        pw = bw;
        ph = pnh * (bw / pnw);
      } else {
        pw = pnw * (bh / pnh);
        ph = bh;
      }

      if (picIsRotated) {
        var tmp = pw;
        pw = ph;
        ph = tmp;
      }
    } else {
      ph = pnh;
      pw = pnw;
    }

    pic.height = ph;
    pic.width = pw;
    pic.style.top = ((bh - ph) / 2) + "px";
    pic.style.left = ((bw - pw) / 2) + "px";

    picZoomLevel = Math.round((pic.height / pic.naturalHeight) * 100);
    SetZoomInfo();
  }

  function SetZoomInfo() {
    document.getElementById("zoomInfo").innerHTML = "<div>Zoom: " + Math.round(picZoomLevel) + "</div>";
  }

  function SetVideo(src) {
    var vid = document.getElementById("vid");
    vid.src = src;
    //vid.requestFullscreen();
    SwitchToCurrentMediaItem("video");
  }

  function SetImage(src, orientation) {
    var pic = GetFullPic(false);
    if (pic === undefined || pic === null) return;
    pic.style.top = null;
    pic.style.left = null;
    pic.style.transform = "rotate(" + orientation + "deg)";
    pic.src = src;
  }

  function SwitchToCurrentMediaItem(mediaType) {
    switch (mediaType) {
      case "image": {
        document.getElementById("videoBox").style.display = "none";
        document.getElementById("vid").src = "";
        document.getElementById("imageBox").style.display = "block";
        var currentPic = GetFullPic(true);
        currentPic.style.display = "none";
        currentPic.style.animation = "";
        GetFullPic(false).style.display = "block";
        currentFullPicId = GetTempFullPicId();
        break;
      }
      case "video": {
        document.getElementById("videoBox").style.display = "block";
        document.getElementById("imageBox").style.display = "none";
        break;
      }
    }
  }

  function GetFullPic(current) {
    return document.getElementById(current ? currentFullPicId : GetTempFullPicId());
  }

  function GetTempFullPicId() {
    return currentFullPicId === "fullPicA" ? "fullPicB" : "fullPicA";
  }

  function SetInfo(infoText) {
    var info = document.getElementById("info");
    if (info === undefined || info === null) return;
    info.innerHTML = infoText;
  }

  function DocReady() {
    //SetPicture("d:/Pictures/01 Digital_Foto/-=Hotovo/2017/2017_05_15+ - Embalse de Zahara/20170515_202305_Martin.jpg", 0);
    //SetPicture("d:/Pictures/01 Digital_Foto/-=Sklad/!/20170913_181620_Martin.jpg", 90);

    window.addEventListener("keydown", WindowKeyDown);
  }

  function AnimatePic() {
    if (!picIsBiggerThanScreen || picIsZoomed) return;
    var pic = GetFullPic(true);
    var pnh = picIsRotated ? pic.naturalWidth : pic.naturalHeight;
    var pnw = picIsRotated ? pic.naturalHeight : pic.naturalWidth;
    if ((pnh / pnw) > (9 / 24)) return;

    var bh = window.document.body.clientHeight;
    var bw = window.document.body.clientWidth;
    var zoom = (bh / pnh) * 100;
    SetPic(pic, zoom, pic.height / 2, pic.width / 2, bh / 2, bw / 2, false);
    var fromLeft = picIsRotated ? (pic.height - bw) / 2 : 0;
    var toLeft = picIsRotated ? (bw - pic.height) / 2 : bw - pic.width;// bw - (picIsRotated ? pic.height : pic.width);
    var animationSpeed = Math.round(toLeft / 100) * -1;

    var animatePicRule = document.styleSheets[0].cssRules[0];
    animatePicRule.deleteRule(1);
    animatePicRule.appendRule("from { left: " + fromLeft + "px;}", 0);
    animatePicRule.appendRule("to { left: " + toLeft + "px;}", 1);
    pic.style.animation = "animatePic " + animationSpeed + "s ease-in-out 0s infinite alternate";
  }

  function WindowKeyDown(event) {
    switch (event.keyCode) {
    case 107:
      Zoom(true);
      break;
    case 109:
      Zoom(false);
      break;
    case 65:
      AnimatePic();
      break;
    }
  };
</script>

<style>
  /*this needs to be first!!!*/
   @keyframes animatePic {
     from { left: 0px;}
     to { left: 100px; }
   }

  body, html {
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
    font-family: sans-serif;
    font-size: 16px;
    background-color: #252525;
    overflow: hidden;
  }

  #fullPicA, #fullPicB {
    position: absolute;
    z-index: 1;
  }

  #info, #zoomInfo {
    position: absolute;
    color: white;
    font-size: 18px;
    z-index: 2;
  }

  #info div, #zoomInfo div {
    margin: 2px;
    padding: 2px;
    background-color: rgba(0, 0, 0, 0.4);
    display: inline-block;
    border: 1px solid black;
  }

  #zoomInfo {
    margin-top: 31px;
  }

  #vid {
    margin: 0 auto;
  }
</style>
</head>
<body OnLoad="DocReady();" OnMouseWheel="Body_OnMouseWheel(event);" OnResize="FitPicture(GetFullPic(true));">
<div id="info"></div>
<div id="zoomInfo"></div>
<div id="content">
  <div id="imageBox">
    <img id="fullPicA" draggable="false"
         OnMouseDown="FullPic_OnMouseDown(event);"
         OnMouseUp="FullPic_OnMouseUp(this);"
         OnMouseMove="FullPic_OnMouseMove(event);"
         OnLoad="FullPic_OnLoad(this);"
         src="">
    <img id="fullPicB" draggable="false"
         OnMouseDown="FullPic_OnMouseDown(event);"
         OnMouseUp="FullPic_OnMouseUp(this);"
         OnMouseMove="FullPic_OnMouseMove(event);"
         OnLoad="FullPic_OnLoad(this);"
         src="">
  </div>
  <div id="videoBox">
    <video id="vid" controls autoplay loop src=""></video>
  </div>
</div>
</body>
</html>