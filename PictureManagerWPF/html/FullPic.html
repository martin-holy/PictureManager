<!-- saved from url=(0026)http://msdn.microsoft.com/ -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Picture Manager - Full Picture Size</title>

    <script>
      var picIsBiggerThanScreen;
      var clientMouseDownX;
      var clientMouseDownY;
      var picMarginTop;
      var picMarginLeft;
      var picMouseIsDown;
      var picIsRotated;
      var picIsZoomed;
      var picZoomLevel;
      var currentFullPicId = "fullPicA";

      //to enable ScriptErrorsSuppressed = true
      function noError() { return true; }
      window.onerror = noError;

      function Body_OnMouseWheel(event) {
        window.external.FullPicMouseWheel(event.wheelDelta);
      }

      function Zoom(zoomIn) {
        if (!zoomIn && picZoomLevel <= 10) return;
        var pic = document.getElementById(currentFullPicId);
        var halfBh = Math.round(window.document.body.clientHeight / 2);
        var halfBw = Math.round(window.document.body.clientWidth / 2);
        picIsZoomed = true;
        //SetPic(pic, zoomIn ? picZoomLevel + 10 : picZoomLevel - 10, halfBh - pic.offsetTop, halfBw - pic.offsetLeft, halfBh, halfBw);

        
        picZoomLevel += zoomIn ? 10 : -10;

        SetPicture2(pic, halfBw, 0);
        SetZoomInfo();
      }

      function SetPicture2(pic, scrX, scrY) {
        var oldH = pic.height;
        var oldW = pic.width;
        var halfBh = Math.round(window.document.body.clientHeight / 2);
        var halfBw = Math.round(window.document.body.clientWidth / 2);

        pic.height = Math.round((pic.naturalHeight / 100) * picZoomLevel);
        pic.width = Math.round((pic.naturalWidth / 100) * picZoomLevel);

        pic.style.marginTop = Math.round(pic.offsetTop - ((pic.height - oldH) / 2) + (halfBh - scrY)) + "px";
        pic.style.marginLeft = Math.round(pic.offsetLeft - ((pic.width - oldW) / 2) - (halfBw - scrX)) + "px";
      }

      /*function Zoom(zoomIn) {
        var pic = document.getElementById(currentFullPicId);
        var oldH = pic.height;
        var oldW = pic.width;

        picIsZoomed = true;

        SetPicZoom(zoomIn ? picZoomLevel + 10 : picZoomLevel - 10);

        picMarginTop = pic.offsetTop - ((pic.height - oldH) / 2);
        picMarginLeft = pic.offsetLeft - ((pic.width - oldW) / 2);

        pic.style.marginTop = picMarginTop + "px";
        pic.style.marginLeft = picMarginLeft + "px";

        SetZoomInfo();
      }*/

      function SetPic(pic, zoom, picT, picL, scrT, scrL) {
        //alert("zoom: " + zoom + ", picT: " + picT + ", picL: " + picL + ", scrT: " + scrT + ", scrL: " + scrL);
        var oZoom = picZoomLevel;
        picT = (zoom / oZoom) * picT;
        picL = (zoom / oZoom) * picL;
        picZoomLevel = zoom;
        pic.height = (pic.naturalHeight / 100) * picZoomLevel;
        pic.width = (pic.naturalWidth / 100) * picZoomLevel;

        if (picIsRotated) {
          var offset = ((pic.naturalWidth - pic.naturalHeight) / 2);
          picMarginTop = Math.round(offset + scrL - ((pic.naturalWidth / pic.width) * picL));
          picMarginLeft = Math.round((offset * -1) + scrT - ((pic.naturalHeight / pic.height) * picT));
        } else {
          picMarginTop = Math.round(scrL - ((pic.naturalHeight / pic.height) * picL));
          picMarginLeft = Math.round(scrT - ((pic.naturalWidth / pic.width) * picT));
        }

        pic.style.marginTop = picMarginTop + "px";
        pic.style.marginLeft = picMarginLeft + "px";
      }

      function SetPicZoom(pic, zoom) {
        picZoomLevel = zoom;
        pic.height = (pic.naturalHeight / 100) * picZoomLevel;
        pic.width = (pic.naturalWidth / 100) * picZoomLevel;
      }

      function FullPic_OnMouseDown(event) {
        picMouseIsDown = true;
        clientMouseDownX = event.clientX;
        clientMouseDownY = event.clientY;

        if (picIsBiggerThanScreen && !picIsZoomed) {
          SetPic(event.currentTarget, 100, event.x, event.y, event.clientX, event.clientY);
        }
      }

      function FullPic_OnMouseUp(sender) {
        picMouseIsDown = false;
        if (!picIsZoomed) {
          FitPicture(sender);
        }
      }

      function FullPic_OnMouseMove(event) {
        if (picMouseIsDown && (picIsBiggerThanScreen || picIsZoomed)) {
          var yDiff = clientMouseDownY - event.clientY;
          var xDiff = clientMouseDownX - event.clientX;

          /*picMarginTop = picMarginTop - yDiff;
          picMarginLeft = picMarginLeft - xDiff;
          event.currentTarget.style.marginTop = (picMarginTop) + "px";
          event.currentTarget.style.marginLeft = (picMarginLeft) + "px";*/

          event.currentTarget.style.marginTop = (picMarginTop - yDiff) + "px";
          event.currentTarget.style.marginLeft = (picMarginLeft - xDiff) + "px";
        }
      }

      function FullPic_OnLoad(pic) {
        FitPicture(pic);
        SwitchCurrentFullPicId();
      }

      function FitPicture(pic) {
        if (pic === undefined || pic === null) return;
        picIsZoomed = false;
        pic.removeAttribute("height");
        pic.removeAttribute("width");

        //if the picture is rotated, switch width and height
        picIsRotated = (pic.style.transform.indexOf("270deg") > 0 || pic.style.transform.indexOf("90deg") > 0);

        var bh = window.document.body.clientHeight;
        var bw = window.document.body.clientWidth;
        var pnh;
        var pnw;

        if (picIsRotated) {
          pnw = pic.naturalHeight;
          pnh = pic.naturalWidth;
        } else {
          pnh = pic.naturalHeight;
          pnw = pic.naturalWidth;
        }

        picIsBiggerThanScreen = (pnh > bh) || (pnw > bw);

        var ph;
        var pw;

        if (picIsBiggerThanScreen) { //picture is bigger than window  
          if (bh / pnh > bw / pnw) { //landscape
            pw = bw;
            ph = pnh * (bw / pnw);
          } else {
            pw = pnw * (bh / pnh);
            ph = bh;
          }

          if (picIsRotated) {
            var tmp = pw;
            pw = ph;
            ph = tmp;
          }
        } else {
          ph = pnh;
          pw = pnw;
        }

        pic.height = ph;
        pic.width = pw;
        pic.style.marginTop = ((bh - ph) / 2) + "px";
        pic.style.marginLeft = ((bw - pw) / 2) + "px";

        picZoomLevel = Math.round((pic.height / pic.naturalHeight) * 100);
        SetZoomInfo();
      }

      function SetZoomInfo() {
        document.getElementById("zoomInfo").innerHTML = "<div>Zoom: " + picZoomLevel + "</div>";
      }

      function SetPicture(src, orientation) {
        var pic = document.getElementById(GetTempFullPicId());
        if (pic === undefined || pic === null) return;
        pic.style.marginTop = null;
        pic.style.marginLeft = null;
        pic.style.transform = "rotate(" + orientation + "deg)";
        pic.src = src;
      }

      function SwitchCurrentFullPicId() {
        GetFullPic(true).style.display = "none";
        GetFullPic(false).style.display = "block";
        currentFullPicId = GetTempFullPicId();
      }

      function GetFullPic(current) {
        return document.getElementById(current ? currentFullPicId : GetTempFullPicId());
      }

      function GetTempFullPicId() {
        return currentFullPicId === "fullPicA" ? "fullPicB" : "fullPicA";
      }

      function SetInfo(infoText) {
        var info = document.getElementById("info");
        if (info === undefined || info === null) return;
        info.innerHTML = infoText;
      }
    </script>

    <style>
      body, html {
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        font-family: sans-serif;
        font-size: 16px;
        background-color: #252525;
        overflow: hidden;
      }

      #fullPicBox {
        height: 100%;
        background-position-x: center;
        background-position-y: center;
        background-size: contain;
        background-repeat: no-repeat;
      }

      #info, #zoomInfo {
        position: absolute;
        color: white;
        font-size: 18px;
        z-index: 1;
      }

      #info div, #zoomInfo div {
        margin: 2px;
        padding: 2px;
        background-color: rgba(0, 0, 0, 0.4);
        display: inline-block;
        border: 1px solid black;
      }

      #zoomInfo {
        margin-top: 31px;
      }
    </style>
  </head>
  <body OnMouseWheel="Body_OnMouseWheel(event);" OnResize="FitPicture();">
    <div id="info"></div>
    <div id="zoomInfo"></div>
    <div id="content">
      <div id="fullPicBox">
        <img id="fullPicA" draggable="false"
             OnMouseDown="FullPic_OnMouseDown(event);"
             OnMouseUp="FullPic_OnMouseUp(this);"
             OnMouseMove="FullPic_OnMouseMove(event);"
             OnLoad="FullPic_OnLoad(this);"
             src="">
        <img id="fullPicB" draggable="false"
             OnMouseDown="FullPic_OnMouseDown(event);"
             OnMouseUp="FullPic_OnMouseUp(this);"
             OnMouseMove="FullPic_OnMouseMove(event);"
             OnLoad="FullPic_OnLoad(this);"
             src="">
      </div>
    </div>
  </body>
</html>