<ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
  xmlns:vm="clr-namespace:MovieManager.Common.ViewModels;assembly=MovieManager.Common"
  xmlns:mhu="clr-namespace:MH.UI.WPF.Utils;assembly=MH.UI.WPF">
    
  <DataTemplate DataType="{x:Type vm:ImportVM}">
    <DataTemplate.Resources>
      <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
          <mhu:CachedResourceDictionary Source="MovieSearchResultV.xaml"/>
        </ResourceDictionary.MergedDictionaries>
      </ResourceDictionary>
    </DataTemplate.Resources>

    <Grid HorizontalAlignment="Left" Width="400">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
      </Grid.RowDefinitions>

      <TextBox
        x:Name="titles"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Top"
        VerticalContentAlignment="Top"
        TextWrapping="NoWrap"
        FontSize="14"
        AcceptsReturn="True"
        Text="Pitch Perfect 2"
        MinLines="5"/>

      <ListBox
        x:Name="result"
        Grid.Row="1"
        Height="200"
        ItemsSource="{Binding MovieSearchResults}"
        ItemTemplate="{StaticResource MM.DT.IMovieSearchResult}">

        <b:Interaction.Triggers>
          <b:EventTrigger EventName="MouseLeftButtonUp">
            <b:InvokeCommandAction
              Command="{Binding ResolveSearchMovieResultCommand}"
              CommandParameter="{Binding Path=SelectedItem, ElementName=result}"/>
          </b:EventTrigger>
        </b:Interaction.Triggers>
      </ListBox>

      <StackPanel Grid.Row="2" Orientation="Horizontal">
        <Button
          Margin="5"
          MinHeight="30"
          MinWidth="60"
          HorizontalAlignment="Right"
          Content="Import"
          Command="{Binding ImportMoviesCommand}"
          CommandParameter="{Binding Text, ElementName=titles}"/>

        <Button
          Margin="5"
          MinHeight="30"
          MinWidth="60"
          HorizontalAlignment="Right"
          Content="Test"
          Command="{Binding TestCommand}"/>
      </StackPanel>
      
    </Grid>
  </DataTemplate>
</ResourceDictionary>